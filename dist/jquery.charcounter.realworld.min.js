(function(a){a.fn.charCounter=function(b,d){b=b||140;d=a.extend({container:"<p></p>",classname:"charcounter",format:"(%1 characters remaining)",formatUp:"(%1 characters)",pulse:true,countUp:true,delay:0,enterSubmits:true},d);var h,g;function f(i,j){if(h){window.clearTimeout(h);h=null}i.animate({opacity:0.1},100,function(){a(this).animate({opacity:1},100)});if(j){h=window.setTimeout(function(){f(i)},200)}}function c(i,j,k){if(d.countUp){j.html(d.formatUp.replace(/%1/,k.val().length))}else{j.html(d.format.replace(/%1/,(i-k.val().length)))}}function e(j,i){j=a(j);if(b>0&&j.val().length>b){j.val(j.val().substring(0,b));if(d.pulse&&!h){f(i,true)}}if(d.delay>0){if(g){window.clearTimeout(g)}g=window.setTimeout(function(){c(b,i,j)},d.delay)}else{c(b,i,j)}}return this.each(function(){var i=(!d.container.match(/^<.+>$/))?a(d.container):a(d.container).insertAfter(this).addClass(d.classname);a(this).bind("keydown",function(){if(d.enterSubmits&&event.keyCode===13&&!event.shiftKey&&!event.ctrlKey){event.preventDefault();a(this.form).submit();return false}else{e(this,i)}}).bind("keypress",function(){e(this,i)}).bind("keyup",function(){e(this,i)}).bind("focus",function(){e(this,i)}).bind("mouseover",function(){e(this,i)}).bind("mouseout",function(){e(this,i)}).bind("paste",function(){var j=this;setTimeout(function(){e(j,i)},10)});if(this.addEventListener){this.addEventListener("input",function(){e(this,i)},false)}e(this,i)})}})(jQuery);